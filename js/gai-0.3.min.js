if(typeof jQuery=="undefined"){console.log("GAI: jQuery is not loaded!")}function _gaiLinkedInSuccessfulShare(a){GAI.Storage.linkedInShares.make();GAI.Subscriptions.invokeLinkedInShares();GAI.Ops().sendSocialEvent("LinkedIn","Successful share",a)}function _gaiGooglePlusOne(a){}var GAI;(function(j){j.Debug=false;j.$;var c=(function(){function s(){}s.prototype.sendEvent=function(u,w,t,v){i("Event category: "+u+", action: "+w+", label: "+t+", "+v);ga("send","event",u,w,t,v)};s.prototype.sendSocialEvent=function(u,t,v){i("Social interaction on "+u+" for "+t+" on "+v);ga("send","social",u,t,v)};return s})();var g=(function(){function s(){}s.prototype.sendEvent=function(u,w,t,v){i("Event category: "+u+", action: "+w+", label: "+t+", "+v);_gaq.push(["_trackEvent",u,w,t,v])};s.prototype.sendSocialEvent=function(u,t,v){i("Social interaction on "+u+" for "+t+" on "+v);_gaq.push(["_trackSocial","social",u,t,v])};return s})();var f=(function(){function s(){}s.prototype.sendEvent=function(u,w,t,v){if(typeof t==="undefined"){t=window.undefined}if(typeof v==="undefined"){v=window.undefined}s.error()};s.prototype.sendSocialEvent=function(u,t,v){s.error()};s.error=function(){window.console.log("Google Analytics javascript is not loaded.")};return s})();function e(){if(typeof _opsCache!="undefined"){return _opsCache}if(typeof ga=="function"){_opsCache=new c();return _opsCache}if(typeof _gaq=="object"){_opsCache=new g();return _opsCache}return new f()}j.Ops=e;function i(s){if(j.Debug){window.console.log("GAI: "+s)}}j.Log=i;function m(s){var t=window.document.cookie;var u=t.indexOf(" "+s+"=");if(u==-1){u=t.indexOf(s+"=")}if(u==-1){t=null}else{u=t.indexOf("=",u)+1;var v=t.indexOf(";",u);if(v==-1){v=t.length}t=window.unescape(t.substring(u,v))}return t}var d=(function(){function s(v,t,u){this.urls=v;this.network=t;this.action=u}return s})();var r=(function(){function s(t){this.isSocial=false;this.elem=t;this.analyze()}s.prototype.analyze=function(){var v=this;var t=this.elem.attr("href");var u=t.replace(/^http[s]?:\/\//,"");j.$.each(s.matches,function(x,w){j.$.each(w.urls,function(y,z){if(v.isSocial==false&&u.indexOf(z)==0){v.network=w.network;v.action=w.action;v.target=t;v.isSocial=true;return}})})};s.getQueryVariable=function(v,u){var t=u.split("?");if(t.length<2){return null}var x=t[1];var y=x.split("&");for(var w=0;w<y.length;w++){var z=y[w].split("=");if(z[0]==v){return z[1]}}return null};s.matches=[new d(["facebook.com/sharer","www.facebook.com/sharer"],"Facebook","Share"),new d(["facebook.com/","www.facebook.com/"],"Facebook","Click"),new d(["twitter.com/intent"],"Twitter","Tweet"),new d(["twitter.com"],"Twitter","Click"),new d(["www.linkedin.com/cws/","linkedin.com/cws/"],"LinkedIn","Share"),new d(["www.linkedin.com"],"LinkedIn","Click"),new d(["plus.google.com/share"],"Google+","Share"),new d(["plus.google.com/"],"Google+","Click")];return s})();function h(w){if(w==0||w==1){return this.seconds+" second"}var s=w%60;var u=window.parseInt(w/60);var t=function(x){return x>1?"s":""};var v="";if(u>0){v+=u+" minute"+t(u)}if(u>0&&s>0){v+=", "}if(s>0){v+=s+" second"+t(s)}return v}var q=(function(){function s(){}s.bindFacebook=function(){if(s.facebookBound||typeof window.FB=="undefined"){return}i("Facebook bound");s.facebookBound=true;window.FB.Event.subscribe("edge.create",function(t,u){o.likes.make();k.invokeLikes();e().sendSocialEvent("Facebook","Like",t)});window.FB.Event.subscribe("edge.remove",function(t,u){o.likes.unmake();k.invokeUnlikes();e().sendSocialEvent("Facebook","Unlike",t)});window.FB.Event.subscribe("comment.create",function(t,u){e().sendSocialEvent("Facebook","Add comment",t)});window.FB.Event.subscribe("comment.remove",function(t,u){e().sendSocialEvent("Facebook","Remove comment",t)});window.FB.Event.subscribe("message.send",function(t){o.fbSentMsgs.make();k.invokeFbSendMsg();e().sendSocialEvent("Facebook","Send message",t)})};s.bindTwitter=function(){if(s.twitterBound||typeof window.twttr=="undefined"){return}i("Twitter bound");s.twitterBound=true;window.twttr.events.bind("tweet",function(t){o.tweets.make();k.invokeTweets();e().sendSocialEvent("Twitter","Tweet","Tweet")});window.twttr.events.bind("follow",function(t){o.follows.make();k.invokeFollows();e().sendSocialEvent("Twitter","Follow","@"+t.data.screen_name)})};s.facebookBound=false;s.twitterBound=false;return s})();var p=(function(){function s(t){this.key=t}s.prototype.make=function(){s.additionLocal(this.key,1);s.additionSession(this.key,1)};s.prototype.unmake=function(){s.additionLocal(this.key,-1);s.additionSession(this.key,-1)};s.prototype.getLocalCount=function(){return s.getLocalInt(this.key)};s.prototype.getSessionCount=function(){return s.getSessionInt(this.key)};s.getLocalInt=function(t){if(window.localStorage.getItem("gai_"+t)===null){window.localStorage.setItem("gai_"+t,"0")}return window.parseInt(window.localStorage.getItem("gai_"+t))};s.additionLocal=function(u,v){var t=s.getLocalInt(u);s.setLocalInt(u,t+v)};s.setLocalInt=function(t,u){window.localStorage.setItem("gai_"+t,u)};s.getSessionInt=function(t){if(window.sessionStorage.getItem("gai_"+t)===null){window.sessionStorage.setItem("gai_"+t,"0")}return window.parseInt(window.sessionStorage.getItem("gai_"+t))};s.setSessionInt=function(t,u){window.sessionStorage.setItem("gai_"+t,u)};s.additionSession=function(u,v){var t=s.getSessionInt(u);s.setSessionInt(u,t+v)};return s})();j.StorageElement=p;var o=(function(){function s(){}s.likes=new p("likes");s.fbSentMsgs=new p("fbSentMsgs");s.tweets=new p("tweets");s.follows=new p("follows");s.linkedInShares=new p("linkedInShares");return s})();j.Storage=o;var b=(function(){function s(){this.trackValues=[]}s.prototype.addTrack=function(u,t,v){if(typeof v==="undefined"){v=0}if(/(\.|#)[a-zA-Z0-9_\-]+/.test(u)==false&&/[0-9]+%/.test(u)==false){window.console.log("The value you want to track is not understood: "+u);return}this.trackValues.push({value:u,label:t||u,offset:v})};s.prototype.getOffset=function(v){var u=this.trackValues[v];if(u.value.indexOf("%")>0){return j.$(window.document).height()*window.parseInt(u.value)/100-u.offset}var t=j.$(u.value);if(t.length>0){return t.offset().top-u.offset}else{return null}};s.prototype.sendEvent=function(u){var t=this.trackValues[u];this.trackValues.splice(u,1);e().sendEvent("GAI","Scroll",t.label)};s.prototype.tick=function(){var v=j.$(window).scrollTop()+j.$(window).height();for(var t=0;t<this.trackValues.length;t++){var u=this.getOffset(t);if(v>=u){this.sendEvent(t)}}};return s})();var l=(function(){function s(){this.iframeApiLoaded=false;this.players=[];this.processedIframes=[]}s.prototype.getYoutubeIframes=function(){var w=[];var t=window.document.getElementsByTagName("iframe");for(var u=0;u<t.length;u++){var v=t[u];try{var x=(v).src;if(/^https?:\/\/www\.youtube.com\/embed\//.test(x)){w.push(v)}}catch(v){window.console.log("Can't get iframe url")}}return w};s.prototype.tick=function(){var u=this;var t=this.getYoutubeIframes();if(t.length==0){return}this.includeYoutubeApiJs();if(typeof window.YT!="undefined"){j.$("iframe").each(function(v,w){try{var x=(w).src}catch(w){window.console.log("Can't get iframe src");return}if(/^https?:\/\/www\.youtube.com\/embed\//.test(x)){u.generatePlayerObject(w)}})}};s.prototype.youtubeStateChange=function(w){var t=w.target.getVideoUrl();var v=w.target.getDuration();var u=w.target.getCurrentTime();var x=window.parseInt((100*u)/v);if(w.data==0){e().sendEvent("GAI","Video Finished",t)}else{if(w.data==2&&x<100){e().sendEvent("GAI","Video Stop",t,x)}else{if(w.data==3&&x<100){e().sendEvent("GAI","Video Start",t)}}}};s.youtubeStateValue=function(t){if(t==0){return"End"}switch(t){case 0:return"End";case 1:return"Continue";case 2:return"Stop";case 3:return"Start"}return null};s.prototype.generatePlayerObject=function(u){if(this.players.indexOf(u)>=0){return}if(this.processedIframes.indexOf(u)>=0){return}this.processedIframes.push(u);try{i("Creating YouTube Iframe API Object");var t=new YT.Player(u,{events:{onStateChange:this.youtubeStateChange}});this.players.push({iframe:u,YoutubeApi:t})}catch(v){}};s.prototype.includeYoutubeApiJs=function(){if(this.iframeApiLoaded==true||typeof window.YT!="undefined"){return}i("Including YouTube Iframe API");this.iframeApiLoaded=true;j.$.getScript("//www.youtube.com/iframe_api")};return s})();var n=(function(){function s(){this.funcs=[]}s.prototype.add=function(t){this.funcs.push(t)};s.prototype.invoke=function(){for(var t=0;t<this.funcs.length;t++){this.funcs[t]()}};return s})();var k=(function(){function s(){}s.subscribeLikes=function(t){s.Likes.add(t)};s.invokeLikes=function(){s.Likes.invoke()};s.subscribeUnlikes=function(t){s.Unlikes.add(t)};s.invokeUnlikes=function(){s.Unlikes.invoke()};s.subscribeTweets=function(t){s.Tweets.add(t)};s.invokeTweets=function(){s.Tweets.invoke()};s.subscribeFollows=function(t){s.Follows.add(t)};s.invokeFollows=function(){s.Follows.invoke()};s.subscribeLinkedInShares=function(t){s.LinkedinShares.add(t)};s.invokeLinkedInShares=function(){s.LinkedinShares.invoke()};s.subscribeFbSendMsg=function(t){s.FbSendMsg.add(t)};s.invokeFbSendMsg=function(){s.FbSendMsg.invoke()};s.Likes=new n();s.Unlikes=new n();s.Tweets=new n();s.Follows=new n();s.LinkedinShares=new n();s.FbSendMsg=new n();return s})();j.Subscriptions=k;var a=(function(){function s(t){var u=this;this.scrollTracker=new b();this.instantiateTime=new window.Date();this.YoutubeTracker=new l();this.tickCounter=0;j.$=window.jQuery;this.config={facebookTracking:t.facebookTracking||true,twitterTracking:t.twitterTracking||true,externalLinkTracking:t.externalLinkTracking||true,durationEvents:t.durationEvents||[30,60,180,300],scrollEvents:t.scrollEvents||this.smartScrollEvents(),callback:t.callback||null,externalLinkTimeout:t.externalLinkTimeout||500,externalLinkEventCategory:t.externalLinkEventCategory||"Click",externalLinkEventAction:t.externalLinkEventAction||"External Link",durationEventCategory:t.durationEventCategory||"GAI",durationEventAction:t.durationEventAction||"Duration"};if(this.config.externalLinkTracking==true){this.trackExternalLinks()}j.$.each(this.config.scrollEvents,function(x,w){if(typeof w=="string"){u.scrollEvent(w)}else{u.scrollEvent(w.value,w.label,w.offset)}});j.$.each(this.config.durationEvents,function(x,w){return u.durationEvent(w)});if(typeof this.config.callback=="function"){this.config.callback()}this.tick();if(window.location.hostname=="localhost"||m("gaiDebug")=="1"){j.Debug=true}}s.prototype.scrollEvent=function(u,t,v){if(typeof v==="undefined"){v=0}this.scrollTracker.addTrack(u,t,v)};s.prototype.durationEvent=function(t){var u=this;window.setTimeout(function(){e().sendEvent(u.config.durationEventCategory,u.config.durationEventAction,h(t))},t*1000)};s.prototype.smartScrollEvents=function(){var t=j.$(window).height();var u=j.$(window.document).height();if(u>t*3){return["50%","90%"]}if(u>t*2){return["80%"]}if(u>t*1.2){return["95%"]}return[]};s.prototype.trackExternalLinks=function(){var u=this;var t=function(v){v.one("mousedown",function(){var y=v.attr("href");y=y.replace(/^http[s]?:\/\//,"");var B=y.split("/")[0];if(B==window.host){return}var x=v.attr("data-gai-event-category")||u.config.externalLinkEventCategory;var A=v.attr("data-gai-event-action")||u.config.externalLinkEventAction;var z=v.attr("data-gai-event-label")||y;var w=new r(v);if(w.isSocial){e().sendSocialEvent(w.network,w.action,w.target)}else{e().sendEvent(x,A,z)}if(v.attr("target")!="_blank"||y.indexOf("mailto:")==0){v.click(function(C){C.preventDefault()});window.setTimeout('document.location = "'+y+'"',u.config.externalLinkTimeout)}})};j.$('a[target="_blank"], a[href^="mailto:"]').each(function(){var v=j.$(this).attr("href");if(typeof v=="undefined"||v==""||v=="#"||/^javascript:/.test(v)){return}if(/^https?:\/\//.test(this.href)||this.href.indexOf("mailto:")==0){t(j.$(this))}})};s.prototype.tick=function(){var t=this;window.setInterval(function(){t.tickCounter++;if(t.config.facebookTracking&&!q.facebookBound){q.bindFacebook()}if(t.config.twitterTracking&&!q.twitterBound){q.bindTwitter()}t.scrollTracker.tick();if(new Date().getTime()-t.instantiateTime.getTime()>1000&&t.tickCounter%8==0){t.YoutubeTracker.tick()}},500)};return s})();j.Manager=a})(GAI||(GAI={}));window.gaiManager=new GAI.Manager(window._gaicnf||{});
